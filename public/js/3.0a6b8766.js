(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{8041:function(e,t,n){"use strict";var a=n("af78"),s=n.n(a);s.a},"8b24":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex flex-center q-pa-md"},[n("div",{staticClass:"container"},[n("div",{staticClass:"video-container"},[n("video",{ref:"peer",attrs:{width:"640",height:"360",controls:"",playsinline:"",autoplay:""}})])]),n("div",{staticClass:"self"},[n("div",{staticClass:"video-container"},[n("video",{ref:"self",attrs:{width:"128",height:"72",muted:"",playsinline:"",autoplay:""},domProps:{muted:!0}})])])])},s=[],i=n("967e"),r=n.n(i),c=(n("96cf"),n("fa84")),o=n.n(c),d=(n("ac6a"),n("cadf"),n("06db"),n("5df3"),n("f400"),new Map),u={iceServers:[{urls:["stun:stun.l.google.com:19302"]}]},f={name:"PageIndex",mounted:function(){var e=this;this.ws=new WebSocket("wss://".concat(location.host,"/room"));var t=this;this.ws.addEventListener("open",function(){var n=o()(r.a.mark((function n(a){var s;return r.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.ws.addEventListener("message",function(){var e=o()(r.a.mark((function e(n){var a,s,i,c,o,f,l;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=JSON.parse(n.data),e.t0=a.t,e.next="watcher.add"===e.t0?4:"candidate"===e.t0?11:"answer"===e.t0?14:"offer"===e.t0?18:31;break;case 4:return console.log("watcher.add: "+a.id),s=null,d.has(a.id)?s=d.get(a.id):(s=new RTCPeerConnection(u),d.set(a.id,s),s.onicecandidate=function(e){e.candidate&&t.ws.send(JSON.stringify({t:"candidate",id:a.id,message:e.candidate}))}),i=t.$refs.self.srcObject,i.getTracks().forEach((function(e){return s.addTrack(e,i)})),s.createOffer().then((function(e){return s.setLocalDescription(e)})).then((function(){t.ws.send(JSON.stringify({t:"offer",id:a.id,message:s.localDescription}))})),e.abrupt("break",31);case 11:return c=d.get(a.id),c.addIceCandidate(new RTCIceCandidate(a.message)).catch((function(e){console.error(e)})),e.abrupt("break",31);case 14:return console.log("answer"),o=d.get(a.id),o.setRemoteDescription(a.message),e.abrupt("break",31);case 18:return console.log("offer"),f=null,d.has(a.id)?f=d.get(a.id):(f=new RTCPeerConnection(u),d.set(a.id,f),f.onicecandidate=function(e){e.candidate&&t.ws.send(JSON.stringify({t:"candidate",id:a.id,message:e.candidate}))}),f.ontrack=function(e){t.$refs.peer.srcObject=e.streams[0]},e.next=24,f.setRemoteDescription(a.message);case 24:return e.next=26,f.createAnswer();case 26:return l=e.sent,e.next=29,f.setLocalDescription(l);case 29:return t.ws.send(JSON.stringify({t:"answer",id:a.id,message:f.localDescription})),e.abrupt("break",31);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.next=3,/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?navigator.mediaDevices.getUserMedia({audio:!1,video:!0}):navigator.mediaDevices.getDisplayMedia({audio:!1,video:!0});case 3:s=n.sent,e.$refs.self.srcObject=s,e.ws.send(JSON.stringify({t:"broadcast.start"}));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}},l=f,p=(n("8041"),n("2877")),g=n("eebe"),w=n.n(g),v=n("9989"),h=Object(p["a"])(l,a,s,!1,null,null,null);t["default"]=h.exports;w()(h,"components",{QPage:v["a"]})},af78:function(e,t,n){}}]);